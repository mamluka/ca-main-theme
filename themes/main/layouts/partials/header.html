<nav class="navbar c-navbar" role="navigation" aria-label="main navigation">
    <div class="navbar-brand">
        <a class="navbar-item" href="{{ .Site.BaseURL }}">
            {{ .Site.Params.title }}
        </a>

        <a role="button" class="navbar-burger burger" aria-label="menu" aria-expanded="false" data-target="navbarBasicExample" href="#slide-mega-menu">
            <span aria-hidden="true"></span>
            <span aria-hidden="true"></span>
            <span aria-hidden="true"></span>
        </a>
    </div>

    <div class="navbar-menu">
        <div class="navbar-start">
            <div class="navbar-item">

                {{ $homepage := .LiteParent }}
                {{ if .IsPage }}
                {{ $homepage = $.Site.GetLitePageByPageId (index (last 3 .AllAboveSectionsPageIds ) 0) }}
                {{ end}}
                <nav class="mega-menu">
                    <ul>
                        <li>
                            <a href="#slide-mega-menu" class="menu-btn">
                                <span></span>
                            </a>
                        </li>
                        {{ if gt (len $.SubSectionsPageIds) 0 }}
                        <li><a href="{{ $.Permalink }}">Sub sections</a>
                            <ul>
                                {{ range $.SubSectionsPageIds }}
                                {{ $subsection := $.Site.GetLitePageByPageIdByString .}}
                                {{ if $subsection }}
                                <li>
                                    <a href="{{ $subsection.Permalink }}">
                                        {{ $subsection.Title }}
                                    </a>
                                </li>
                                {{ end }}
                                {{ end }}
                            </ul>
                        </li>
                        {{ end }}
                        {{ if or .IsSection .IsPage }}
                        {{ if $homepage }}
                        {{ range first 6 $homepage.SubSectionsPageIds }}
                        {{ $page := $.Site.GetLitePageByPageIdByString . }}
                        {{ if $page }}
                        <li>
                            <a href="{{ $page.Permalink }}">
                                {{ $page.Title }}
                            </a>
                            <ul>
                                {{ range $page.SubSectionsPageIds }}
                                {{ $child_page := $.Site.GetLitePageByPageIdByString . }}
                                {{ if $child_page }}
                                <li>
                                    <a href="{{ $child_page.Permalink }}">
                                        {{ $child_page.Title }}
                                    </a>
                                </li>
                                {{ end }}
                                {{ end }}

                            </ul>
                        </li>
                        {{ end }}
                        {{ end }}
                        {{ end }}
                        {{ end }}

                    </ul>
                </nav>
            </div>
        </div>
    </div>
</nav>
